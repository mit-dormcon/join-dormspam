import{a as _,t as M,c as z,d as be}from"../chunks/disclose-version.Cn3N6e9m.js";import{h as j,M as je,at as rr,b as Ge,au as tr,av as ve,a as ee,ao as ar,c as Z,C as pe,x as Ae,Z as Ce,a6 as Re,aw as Pe,K as ue,L as _e,ap as nr,j as or,J as ir,ai as Ve,N as sr,O as qe,P as Je,Q as ke,ae as lr,ax as Ne,G as Ye,ay as ur,az as cr,aA as mr,aB as fr,ah as dr,aC as vr,d as _r,aa as pr,aD as hr,I as We,aE as gr,aF as yr,an as wr,aG as V,p as ne,f as N,g as E,r as A,t as F,s as T,e as oe,aH as me,m as h,v as le,as as he,y as re,aI as fe,aJ as br}from"../chunks/runtime.C82Cn4iG.js";import{s as P,d as Le,a as kr}from"../chunks/render.msgOrQN4.js";import{p as Nr,i as q,a as X}from"../chunks/props.DxvKsGRl.js";import{s as ge,a as ae,i as Ke,b as xr}from"../chunks/store.g5rwWi6k.js";import{d as xe,w as Tr}from"../chunks/index.9oInDI2n.js";const Te=0,de=1,Ie=2;function Oe(r,e,t,o,i){j&&je();var c=r,d=rr(),x=or,l,s,f,u,a=(d?pe:Ae)(void 0),n=(d?pe:Ae)(void 0),m=!1;function g(v,y){m=!0,y&&(Ce(p),Re(p),Pe(x)),v===Te&&t&&(s?ue(s):s=ee(()=>t(c))),v===de&&o&&(f?ue(f):f=ee(()=>o(c,a))),v===Ie&&i&&(u?ue(u):u=ee(()=>i(c,n))),v!==Te&&s&&_e(s,()=>s=null),v!==de&&f&&_e(f,()=>f=null),v!==Ie&&u&&_e(u,()=>u=null),y&&(Pe(null),Re(null),Ce(null),nr())}var p=Ge(()=>{if(l!==(l=e())){if(tr(l)){var v=l;m=!1,v.then(y=>{v===l&&(ve(a,y),g(de,!0))},y=>{v===l&&(ve(n,y),g(Ie,!0))}),j?t&&(s=ee(()=>t(c))):ar(()=>{m||g(Te,!0)})}else ve(a,l),g(de,!1);return()=>l=null}});j&&(c=Z)}let Ee=null;function Ir(r,e){return e}function Er(r,e,t,o){for(var i=[],c=e.length,d=0;d<c;d++)fr(e[d].e,i,!0);var x=c>0&&i.length===0&&t!==null;if(x){var l=t.parentNode;dr(l),l.append(t),o.clear(),G(r,e[0].prev,e[c-1].next)}vr(i,()=>{for(var s=0;s<c;s++){var f=e[s];x||(o.delete(f.k),G(r,f.prev,f.next)),_r(f.e,!x)}})}function Ar(r,e,t,o,i,c=null){var d=r,x={flags:e,items:new Map,first:null};j&&je();var l=null,s=!1;Ge(()=>{var f=t(),u=ir(f)?f:f==null?[]:Ve(f),a=u.length;if(s&&a===0)return;s=a===0;let n=!1;if(j){var m=d.data===sr;m!==(a===0)&&(d=qe(),Je(d),ke(!1),n=!0)}if(j){for(var g=null,p,v=0;v<a;v++){if(Z.nodeType===8&&Z.data===lr){d=Z,n=!0,ke(!1);break}var y=u[v],w=o(y,v);p=Qe(Z,x,g,null,y,w,v,i,e),x.items.set(w,p),g=p}a>0&&Je(qe())}j||Mr(u,x,d,i,e,o),c!==null&&(a===0?l?ue(l):l=ee(()=>c(d)):l!==null&&_e(l,()=>{l=null})),n&&ke(!0),t()}),j&&(d=Z)}function Mr(r,e,t,o,i,c){var d=r.length,x=e.items,l=e.first,s=l,f,u=null,a=[],n=[],m,g,p,v;for(v=0;v<d;v+=1){if(m=r[v],g=c(m,v),p=x.get(g),p===void 0){var y=s?s.e.nodes_start:t;u=Qe(y,e,u,u===null?e.first:u.next,m,g,v,o,i),x.set(g,u),a=[],n=[],s=u.next;continue}if(Lr(p,m,v),p.e.f&Ne&&ue(p.e),p!==s){if(f!==void 0&&f.has(p)){if(a.length<n.length){var w=n[0],I;u=w.prev;var b=a[0],D=a[a.length-1];for(I=0;I<a.length;I+=1)$e(a[I],w,t);for(I=0;I<n.length;I+=1)f.delete(n[I]);G(e,b.prev,D.next),G(e,u,b),G(e,D,w),s=w,u=D,v-=1,a=[],n=[]}else f.delete(p),$e(p,s,t),G(e,p.prev,p.next),G(e,p,u===null?e.first:u.next),G(e,u,p),u=p;continue}for(a=[],n=[];s!==null&&s.k!==g;)s.e.f&Ne||(f??(f=new Set)).add(s),n.push(s),s=s.next;if(s===null)continue;p=s}a.push(p),u=p,s=p.next}if(s!==null||f!==void 0){for(var L=f===void 0?[]:Ve(f);s!==null;)s.e.f&Ne||L.push(s),s=s.next;var O=L.length;if(O>0){var k=null;Er(e,L,k,x)}}Ye.first=e.first&&e.first.e,Ye.last=u&&u.e}function Lr(r,e,t,o){ve(r.v,e),r.i=t}function Qe(r,e,t,o,i,c,d,x,l){var s=Ee;try{var f=(l&ur)!==0,u=(l&cr)===0,a=f?u?Ae(i):pe(i):i,n=l&mr?pe(d):d,m={i:n,v:a,k:c,a:null,e:null,prev:t,next:o};return Ee=m,m.e=ee(()=>x(r,a,n),j),m.e.prev=t&&t.e,m.e.next=o&&o.e,t===null?e.first=m:(t.next=m,t.e.next=m.e),o!==null&&(o.prev=m,o.e.prev=m.e),m}finally{Ee=s}}function $e(r,e,t){for(var o=r.next?r.next.e.nodes_start:t,i=e?e.e.nodes_start:t,c=r.e.nodes_start;c!==o;){var d=pr(c);i.before(c),c=d}}function G(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}let He=!1;function Ze(){He||(He=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var e;if(!r.defaultPrevented)for(const t of r.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function Or(r){if(j){var e=!1,t=()=>{if(!e){if(e=!0,r.hasAttribute("value")){var o=r.value;Me(r,"value",null),r.value=o}if(r.hasAttribute("checked")){var i=r.checked;Me(r,"checked",null),r.checked=i}}};r.__on_r=t,hr(t),Ze()}}function Me(r,e,t,o){var i=r.__attributes??(r.__attributes={});j&&(i[e]=r.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&r.nodeName==="LINK")||i[e]!==(i[e]=t)&&(e==="loading"&&(r[gr]=t),t==null?r.removeAttribute(e):typeof t!="string"&&Sr(r).includes(e)?r[e]=t:r.setAttribute(e,t))}var Ue=new Map;function Sr(r){var e=Ue.get(r.nodeName);if(e)return e;Ue.set(r.nodeName,e=[]);for(var t,o=We(r),i=Element.prototype;i!==o;){t=yr(o);for(var c in t)t[c].set&&e.push(c);o=We(o)}return e}function Dr(r,e,t,o=t){r.addEventListener(e,t);const i=r.__on_r;i?r.__on_r=()=>{i(),o()}:r.__on_r=o,Ze()}function Cr(r,e,t=e){Dr(r,"change",()=>{var o=r.checked;t(o)}),e()==null&&t(!1),wr(()=>{var o=e();r.checked=!!o})}const Rr=!1,Ht=Object.freeze(Object.defineProperty({__proto__:null,ssr:Rr},Symbol.toStringTag,{value:"Module"}));function Pr(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Xe={exports:{}};(function(r){var e=function(){var t="__winchan_relay_frame",o="die";function i(a,n,m){a.attachEvent?a.attachEvent("on"+n,m):a.addEventListener&&a.addEventListener(n,m,!1)}function c(a,n,m){a.detachEvent?a.detachEvent("on"+n,m):a.removeEventListener&&a.removeEventListener(n,m,!1)}function d(){if(typeof navigator>"u")return!1;var a=-1,n=navigator.userAgent;if(navigator.appName==="Microsoft Internet Explorer"){var m=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");m.exec(n)!=null&&(a=parseFloat(RegExp.$1))}else if(n.indexOf("Trident")>-1){var m=new RegExp("rv:([0-9]{2,2}[.0-9]{0,})");m.exec(n)!==null&&(a=parseFloat(RegExp.$1))}return a>=8}function x(){try{var a=navigator.userAgent;return a.indexOf("Fennec/")!=-1||a.indexOf("Firefox/")!=-1&&a.indexOf("Android")!=-1}catch{}return!1}function l(){return typeof window<"u"&&window.JSON&&window.JSON.stringify&&window.JSON.parse&&window.postMessage}function s(a){/^https?:\/\//.test(a)||(a=window.location.href);var n=/^(https?:\/\/[\-_a-zA-Z\.0-9:]+)/.exec(a);return n?n[1]:a}function f(){for(var a=window.opener.frames,n=a.length-1;n>=0;n--)try{if(a[n].location.protocol===window.location.protocol&&a[n].location.host===window.location.host&&a[n].name===t)return a[n]}catch{}}var u=d();return l()?{open:function(a,n){if(!n)throw"missing required callback argument";var m;a.url||(m="missing required 'url' parameter"),a.relay_url||(m="missing required 'relay_url' parameter"),m&&setTimeout(function(){n(m)},0),a.window_name||(a.window_name=null),(!a.window_features||x())&&(a.window_features=void 0);var g,p=a.origin||s(a.url);if(p!==s(a.relay_url))return setTimeout(function(){n("invalid arguments: origin of url and relay_url must match")},0);var v;u&&(g=document.createElement("iframe"),g.setAttribute("src",a.relay_url),g.style.display="none",g.setAttribute("name",t),document.body.appendChild(g),v=g.contentWindow);var y=a.popup||window.open(a.url,a.window_name,a.window_features);a.popup&&(y.location.href=a.url),v||(v=y);var w=setInterval(function(){y&&y.closed&&(b(),n&&(n("User closed the popup window"),n=null))},500),I=JSON.stringify({a:"request",d:a.params});function b(){if(g&&document.body.removeChild(g),g=void 0,w&&(w=clearInterval(w)),c(window,"message",D),c(window,"unload",b),y)try{y.close()}catch{v.postMessage(o,p)}y=v=void 0}i(window,"unload",b);function D(L){if(L.origin===p){try{var O=JSON.parse(L.data)}catch(k){if(n)return n(k);throw k}O.a==="ready"?v.postMessage(I,p):O.a==="error"?(b(),n&&(n(O.d),n=null)):O.a==="response"&&(b(),n&&(n(null,O.d),n=null))}}return i(window,"message",D),{originalPopup:y,close:b,focus:function(){if(y)try{y.focus()}catch{}}}},onOpen:function(a){var n="*",m=u?f():window.opener;if(!m)throw"can't find relay frame";function g(w){w=JSON.stringify(w),u?m.doPost(w,n):m.postMessage(w,n)}function p(w){var I;try{I=JSON.parse(w.data)}catch{}!I||I.a!=="request"||(c(window,"message",p),n=w.origin,a&&setTimeout(function(){a(n,I.d,function(b){a=void 0,g({a:"response",d:b})})},0))}function v(w){if(w.data===o)try{window.close()}catch{}}i(u?m:window,"message",p),i(u?m:window,"message",v);try{g({a:"ready"})}catch{i(m,"load",function(I){g({a:"ready"})})}var y=function(){try{c(u?m:window,"message",v)}catch{}a&&g({a:"error",d:"client closed window"}),a=void 0;try{window.close()}catch{}};return i(window,"unload",y),{detach:function(){c(window,"unload",y)}}}}:{open:function(a,n,m,g){setTimeout(function(){g("unsupported browser")},0)},onOpen:function(a){setTimeout(function(){a("unsupported browser")},0)}}}();r.exports&&(r.exports=e)})(Xe);var qr=Xe.exports;const Jr=Pr(qr),ze="https://webathena.mit.edu",Fe="ATHENA.MIT.EDU",Yr=[{realm:Fe,principal:["moira","moira7.mit.edu"]},{realm:Fe,principal:["smtp","outgoing.mit.edu"]}];function Wr(){let r,e;const t=new Promise((o,i)=>{r=o,e=i});return Jr.open({url:`${ze}/#!request_ticket_v1`,relay_url:`${ze}/relay.html`,params:{services:Yr}},function(o,i){console.log("Webathena responded with",i),o?(console.error("There was a WebAthena error:",o),e(o)):i.status!=="OK"?e(o):r(i.sessions)}),t}function $r(r){if(r===null)return null;const e=r[0];return btoa(JSON.stringify(e))}function Hr(r){if(r===null)return null;const e=r[1];return btoa(JSON.stringify(e))}function Ur(r){return r===null?null:r[0].cname.nameString[0]}var zr=M(`<h1><img src="/spam.jpg" alt="spam (the food)" id="spam" class="svelte-1g0r8ge"> Join dormspam</h1> <p>Do you want to stay informed about what happens on campus?</p> <details><summary>Click for frequently asked questions</summary> <strong>What is dormspam?</strong> <ul><li>Dormspam is a bunch of email lists which you can send to (and receive from!), in order to get
			information about clubs, events on campus, sales, and more!</li> <li>The email lists are organized by dorm/living group. This website exists to centralize joining
			dormspam into one place.</li> <li>Dormspam, and bulk email lists in general, have a <a href="https://mitadmissions.org/blogs/entry/mailing-list-culture/">long</a> <a href="https://mitadmissions.org/blogs/entry/an_explanation/">history</a> at MIT, and is a really important part of MIT culture! You can join for now if you want to figure
			out what dormspam is all about, and so you don't miss out on anything, and if you decide later
			that you want to filter it or stop receiving it altogether, that's okay too! You can come back
			to this website if you want to unsubscribe!</li></ul> <strong>What kinds of emails get sent to dormspam?</strong> <ul><li>Anything! Most emails are advertisements such as performances/events or club meetings (often
			with free food or boba!), but other common emails include sales (with cheap
			furniture/clothes/AC units), job/UROP opportunities, and silly surveys.</li> <li>The great thing about dormspam is that anyone can send anything they want, and the lists are
			generally unmoderated. That means that sometimes, controversial topics that you disagree with
			may get discussed. But of course, you can filter your email however you want to, and you don't
			need to read emails that you don't want to engage with!</li></ul> <strong>How do I send emails to dormspam?</strong> <ul><li><a href="https://how-to-dormspam.mit.edu">dormspam.mit.edu</a> is a great resource which tells
			you all the norms for sending dormspam emails correctly, so people can filter properly!</li></ul> <strong>What dormspam list should I be on?</strong> <ul><li>This website automatically identifies which dorm you live in, and tells you how to join that
			list.</li> <li>If you don't live in a dorm, it will redirect you to <code>random-hall-dormspam</code>, which
			is run by Random Hall, but is open to all current undergraduate and graduate students. <code>random-hall-dormspam</code> does not get any traffic other than dormspam.</li></ul></details>`,1);function Fr(r){var e=zr();V(4),_(r,e)}var Br=M('<img src="/pacman.gif" alt="Loading...">');function Se(r){var e=Br();_(r,e)}const jr="https://moira-api.mit.edu";async function ye({method:r,path:e,ticket:t,params:o}){let i="";if(o!==void 0){i="?";for(const[l,s]of o)i+=`${l}=${s}&`;i=i.slice(0,-1)}const c=await fetch(`${jr}${e}${i}`,{headers:{Authorization:`webathena ${t}`,modwith:"dormspam"},method:r}),d=await c.text();if(d==="success")return d;const x=JSON.parse(d);if(c.status!==200)throw x;return x}function De(r){let e;for(const[t,o]of r)o!==void 0&&(e===void 0&&(e=new Map),e.set(t,o.toString()));return e}async function Gr(r,e="me",t,o){const i=await ye({method:"GET",path:`/users/${e}/lists`,ticket:r,params:De(new Map([["include_properties",t],["recurse",o]]))});return Array.isArray(i)&&i.every(c=>typeof c=="string")?(i.sort(),i):[]}async function Vr(r,e,t="me",o="user"){return await ye({method:"PUT",path:`/lists/${e}/members/${t}`,ticket:r,params:De(new Map([["type",o]]))})}async function Kr(r,e,t="me",o="user"){return await ye({method:"DELETE",path:`/lists/${e}/members/${t}`,ticket:r,params:De(new Map([["type",o]]))})}const B={mailman:0,moira:1},te="dormspam-catch-all",Qr="gsc-clearance-hms-",Be=new Map([["baker-house",{friendlyName:"Baker",listName:"baker-forum",listType:B.mailman}],["burton-conner-house",{friendlyName:"BC",listName:"bc-talk",listType:B.moira}],["east-campus",{friendlyName:"East Campus",listName:"ec-discuss",listType:B.moira}],["macgregor-house",{friendlyName:"MacGregor",listName:"macgregor",listType:B.mailman}],["maseeh-hall",{friendlyName:"Maseeh",listName:"maseeh-talk",listType:B.mailman}],["mccormick-hall",{friendlyName:"McCormick",listName:"mccormick-announce",listType:B.moira}],["new-house",{friendlyName:"New House",listName:"nh-forum",listType:B.moira}],["new-vassar",{friendlyName:"New Vassar",listName:"new-vassar-forum",listType:B.mailman}],["next-house",{friendlyName:"Next",listName:"next-forum",listType:B.moira}],["random-hall",{friendlyName:"Random",listName:"random-hall-dormspam",listType:B.moira}],["simmons-hall",{friendlyName:"Simmons",listName:"sponge-talk",listType:B.mailman}]]),Zr=["sponge-talk"],Xr=["baker-forum","maseeh-talk"];var et=M("<p>Permission denied :(</p>"),rt=M("<p> </p>"),tt=M("<h3> </h3> <p> </p>",1);function er(r,e){ne(e,!0);let t=Nr(e,"noResultsError",3,"There is nothing here.");var o=z(),i=N(o);q(i,()=>e.error.name==="MR_PERM",c=>{var d=et();_(c,d)},c=>{var d=z(),x=N(d);q(x,()=>e.error.name==="MR_NO_MATCH",l=>{var s=rt(),f=E(s);A(s),F(()=>P(f,t())),_(l,s)},l=>{var s=tt(),f=N(s),u=E(f);A(f);var a=T(f,2),n=E(a);A(a),F(()=>{P(u,`An error (${e.error.name??""}) occurred`),P(n,e.error.message)}),_(l,s)},!0),_(c,d)}),_(r,o),oe()}var at=M("<p> </p>"),nt=M(`<p><strong>Important info:</strong> Please read or bookmark <a href="https://how-to-dormspam.mit.edu/">how-to-dormspam.mit.edu</a> for instructions on how to
	send emails to everyone on dormspam. This is the <strong>only way</strong> to correctly dormspam.</p> <!>`,1);function ce(r,e){ne(e,!0);var t=nt(),o=T(N(t),2);q(o,()=>e.dormInfo&&e.dormInfo.listName!=te,i=>{var c=at(),d=E(c);A(c),F(()=>P(d,`If you only want to email ${e.dormInfo.friendlyName??""} residents, simply email ${e.dormInfo.listName??""}@mit.edu
		as normal without needing to follow the instructions. This isn't called "dormspamming".`)),_(i,c)}),_(r,t),oe()}async function ot(r,e){return await ye({method:"POST",path:`/mailman/${e}/request_subscription`,ticket:r})}var it=(r,e,t)=>e(t.dormInfo.listName),st=M(`<p>You are in <strong> </strong>. Click the button below to subscribe to
		dormspam:</p> <button id="subscribe"> </button>`,1),lt=M("<p> </p> <!>",1),ut=M("<p> </p> <!>",1),ct=M('<p> <strong>You are not subscribed yet until you confirm your subscription.</strong></p> <p><label><input type="checkbox"> I have finalized my subscription by following the instructions in my email.</label></p>',1),mt=M("<p>Sending email to Mailman...</p> <!>",1),ft=M(`<!> <hr> <p> <a target="_blank"> </a> should also
	let you subscribe or unsubscribe directly.</p>`,1);function dt(r,e){ne(e,!0);const t=ge(),o=()=>ae(c,"$emailTicket",t);let i=le(()=>"https://mailman.mit.edu/mailman/listinfo/"+e.dormInfo.listName);const c=me("emailTicket");let d=he(null);function x(g){re(d,X(ot(o(),g)))}let l=he(!1);var s=ft(),f=N(s);q(f,()=>h(d)===null,g=>{var p=st(),v=N(p),y=T(E(v)),w=E(y);A(y),V(),A(v);var I=T(v,2);I.__click=[it,x,e];var b=E(I);A(I),F(()=>{P(w,e.dormInfo.friendlyName),P(b,`Subscribe me to ${e.dormInfo.listName??""}`)}),_(g,p)},g=>{var p=z(),v=N(p);Oe(v,()=>h(d),y=>{var w=mt(),I=T(N(w),2);Se(I),_(y,w)},y=>{var w=z(),I=N(w);q(I,()=>Zr.includes(e.dormInfo.listName),b=>{var D=lt(),L=N(D),O=E(L);A(L);var k=T(L,2);ce(k,{get dormInfo(){return e.dormInfo}}),F(()=>P(O,`🎉 Successfully subscribed to ${e.dormInfo.listName??""}!`)),_(b,D)},b=>{var D=z(),L=N(D);q(L,()=>Xr.includes(e.dormInfo.listName),O=>{var k=ut(),R=N(k),J=E(R);A(R);var C=T(R,2);ce(C,{get dormInfo(){return e.dormInfo}}),F(()=>P(J,`🎉 You are almost subscribed to ${e.dormInfo.listName??""}! Your request will be reviewed by the ${e.dormInfo.friendlyName??""}
				exec.`)),_(O,k)},O=>{var k=z(),R=N(k);q(R,()=>h(l),J=>{ce(J,{get dormInfo(){return e.dormInfo}})},J=>{var C=ct(),S=N(C),W=E(S);V(),A(S);var H=T(S,2),$=E(H),Y=E($);Or(Y),V(),A($),A(H),F(()=>P(W,`Almost done! You will receive an email from ${e.dormInfo.listName??""}-request@mit.edu with a
				subject that begins with "confirm". Please click on the link inside it. `)),Cr(Y,()=>h(l),U=>re(l,U)),_(J,C)},!0),_(O,k)},!0),_(b,D)}),_(y,w)},(y,w)=>{er(y,{get error(){return h(w)}})}),_(g,p)});var u=T(f,4),a=E(u),n=T(a),m=E(n);A(n),V(),A(u),F(()=>{P(a,`You can also email ${e.dormInfo.listName??""}-owner@mit.edu with any questions (such as help subscribing
	or unsubscribing). The website `),Me(n,"href",h(i)),P(m,h(i))}),_(r,s),oe()}Le(["click"]);var vt=M("<code> </code><!>",1),_t=M(`<p class="notice"><strong>NOTE:</strong> You are already in the dormspam lists of <!> <!>. You can unsubscribe from them using <a href="https://groups.mit.edu/webmoira/">WebMoira</a>. Everything that follows below is
			about subscribing or unsubscribing to your own dorm's dormspam list, since this application is
			mostly designed for people who are joining dormspam for the first time.</p>`),pt=(r,e,t)=>e(h(t).listName),ht=M('<p>You are in <strong> </strong>, and you are already subscribed to <code> </code>.</p> <!> <button id="unsubscribe" class="svelte-zzt34l">Unsubscribe me</button>',1),gt=(r,e,t)=>e(h(t).listName),yt=M(`<p>Since you are in <strong> </strong>, to be on dormspam, you should
				subscribe to <code> </code>.</p> <button id="subscribe"> </button>`,1),wt=(r,e)=>e(te),bt=M('<p>You are already subscribed, though. Do you want to unsubscribe?</p> <button id="unsubscribe" class="svelte-zzt34l">Unsubscribe me from dormspam...</button>',1),kt=(r,e)=>e(te),Nt=M('<button id="subscribe">Subscribe me to dormspam!</button>'),xt=M("<p>We could not detect what dorm you are in. We can subscribe you to <code>random-hall-dormspam</code>, which is open to everyone, whether you are in a dorm or not.</p> <!>",1),Tt=M("<!> <!>",1),It=M("<p> </p> <!>",1),Et=(r,e,t)=>e(h(t)),At=M('<p> </p> <button id="subscribe">I changed my mind, please re-subscribe me</button>',1),Mt=M("<p>Asking Moira to do the thing...</p> <!>",1);function Lt(r,e){ne(e,!0);const t=ge(),o=()=>ae(c,"$ticket",t),i=()=>ae(d,"$username",t),c=me("ticket"),d=me("username");function x(b){const D=b.filter(L=>L.startsWith("gsc-clearance-"));for(const[L,O]of Be.entries()){const k=Qr+L;if(D.includes(k))return O}return null}let l=le(()=>x(e.lists)),s=le(()=>h(l)?h(l).listName:"");function f(b){return e.lists.includes(b)}const u={add:0,remove:1,none:2};let a=he(X(u.none)),n=he(null);function m(b){re(a,X(u.add)),re(n,X(Vr(o(),b,i())))}function g(b){re(a,X(u.remove)),re(n,X(Kr(o(),b,i())))}function p(b){const D=new Set(b),L=[],O=[...Be.values()].map(k=>k.listName);for(const k of O)D.has(k)&&L.push(k);return L}let v=le(()=>p(e.lists)),y=le(()=>h(v).filter(b=>b!==h(s)));var w=z(),I=N(w);q(I,()=>h(a)===u.none,b=>{var D=Tt(),L=N(D);q(L,()=>h(y).length>0,k=>{var R=_t(),J=T(E(R),2);q(J,()=>h(y).length===1,S=>{var W=be("another dorm:");_(S,W)},S=>{var W=be("other dorms:");_(S,W)});var C=T(J,2);Ar(C,17,()=>h(v),Ir,(S,W,H)=>{var $=vt(),Y=N($),U=E(Y);A(Y);var ie=T(Y);q(ie,()=>H<h(y).length-1,K=>{var se=be(",");_(K,se)}),F(()=>P(U,h(W))),_(S,$)}),V(3),A(R),_(k,R)});var O=T(L,2);q(O,()=>h(l),k=>{var R=z(),J=N(R);q(J,()=>h(l).listType===B.mailman,C=>{dt(C,{get dormInfo(){return h(l)}})},C=>{var S=z(),W=N(S);q(W,()=>f(h(l).listName),H=>{var $=ht(),Y=N($),U=T(E(Y)),ie=E(U);A(U);var K=T(U,2),se=E(K);A(K),V(),A(Y);var Q=T(Y,2);ce(Q,{get dormInfo(){return h(l)}});var we=T(Q,2);we.__click=[pt,g,l],F(()=>{P(ie,h(l).friendlyName),P(se,h(l).listName)}),_(H,$)},H=>{var $=yt(),Y=N($),U=T(E(Y)),ie=E(U);A(U);var K=T(U,2),se=E(K);A(K),V(),A(Y);var Q=T(Y,2);Q.__click=[gt,m,l];var we=E(Q);A(Q),F(()=>{P(ie,h(l).friendlyName),P(se,h(l).listName),P(we,`Subscribe me to ${h(l).listName??""}`)}),_(H,$)},!0),_(C,S)}),_(k,R)},k=>{var R=xt(),J=T(N(R),2);q(J,()=>f(te),C=>{var S=bt(),W=T(N(S),2);W.__click=[wt,g],_(C,S)},C=>{var S=Nt();S.__click=[kt,m],_(C,S)}),_(k,R)}),_(b,D)},b=>{var D=z(),L=N(D);Oe(L,()=>h(n),O=>{var k=Mt(),R=T(N(k),2);Se(R),_(O,k)},O=>{var k=z(),R=N(k);q(R,()=>h(a)===u.add,J=>{var C=It(),S=N(C),W=E(S);A(S);var H=T(S,2);ce(H,{get dormInfo(){return h(l)}}),F(()=>P(W,`🎉 Successfully subscribed to ${(h(s)===te?"random-hall-dormspam":h(s))??""}.`)),_(J,C)},J=>{var C=z(),S=N(C);q(S,()=>h(a)===u.remove,W=>{var H=At(),$=N(H),Y=E($);A($);var U=T($,2);U.__click=[Et,m,s],F(()=>P(Y,`😥 Sorry to see you go. You have been unsuccessfully unsubscribed from ${(h(s)===te?"random-hall-dormspam":h(s))??""}.`)),_(W,H)},null,!0),_(J,C)}),_(O,k)},(O,k)=>{er(O,{get error(){return h(k)}})}),_(b,D)}),_(r,w),oe()}Le(["click"]);var Ot=M("<p>Getting information from Moira...</p> <p><!></p>",1);function St(r,e){ne(e,!1);const t=ge(),o=()=>ae(c,"$ticket",t),i=()=>ae(d,"$username",t),c=me("ticket"),d=me("username"),x=Gr(o(),i());Ke();var l=z(),s=N(l);Oe(s,()=>x,f=>{var u=Ot(),a=T(N(u),2),n=E(a);Se(n),A(a),_(f,u)},(f,u)=>{Lt(f,{get lists(){return h(u)}})}),_(r,l),oe()}async function Dt(r,e,t){xr(t,await Wr())}var Ct=M('<p><button id="login">Login with Webathena</button></p>'),Rt=M("<!> <p></p> <!>",1);function Ut(r,e){ne(e,!1);const t=ge(),o=()=>ae(i,"$webathena",t),i=Tr(null);fe("webathena",i);const c=xe(i,$r);fe("ticket",c);const d=xe(i,Hr);fe("emailTicket",d);const x=xe(i,Ur);fe("username",x),Ke();var l=Rt();kr(u=>{br.title="Join dormspam"});var s=N(l);Fr(s);var f=T(s,4);q(f,()=>o()===null,u=>{var a=Ct(),n=E(a);n.__click=[Dt,o,i],A(a),_(u,a)},u=>{St(u,{})}),_(r,l),oe()}Le(["click"]);export{Ut as component,Ht as universal};
